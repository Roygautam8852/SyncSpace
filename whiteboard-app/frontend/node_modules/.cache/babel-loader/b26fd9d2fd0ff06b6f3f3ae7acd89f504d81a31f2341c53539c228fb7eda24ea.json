{"ast":null,"code":"var _jsxFileName = \"D:\\\\CapstoneProject\\\\whiteboard-app\\\\frontend\\\\src\\\\pages\\\\WhiteboardRoom.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport { useAuth } from \"../context/AuthContext\";\nimport { useSocket } from \"../context/SocketContext\";\nimport { roomService } from \"../services/api\";\nimport Toolbar from \"../components/Toolbar\";\nimport Chat from \"../components/Chat\";\nimport StylingPanel from \"../components/StylingPanel\";\nimport toast from \"react-hot-toast\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst WhiteboardRoom = () => {\n  _s();\n  const {\n    roomId\n  } = useParams();\n  const navigate = useNavigate();\n  const {\n    user\n  } = useAuth();\n  const {\n    socket\n  } = useSocket();\n  const canvasRef = useRef(null);\n  const contextRef = useRef(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n\n  // Tools & Styling\n  const [tool, setTool] = useState(\"pencil\");\n  const [showStyling, setShowStyling] = useState(true);\n  const [color, setColor] = useState(\"#000000\");\n  const [size, setSize] = useState(4);\n  const [opacity, setOpacity] = useState(1);\n  const [strokeStyle, setStrokeStyle] = useState('solid');\n  const [fill, setFill] = useState(false);\n  const colors = [\"#000000\", \"#475569\", \"#dc2626\", \"#ea580c\", \"#d97706\", \"#65a30d\", \"#0891b2\", \"#2563eb\", \"#7c3aed\", \"#db2777\"];\n  const isDrawingTool = [\"pencil\", \"highlighter\", \"rect\", \"circle\", \"line\", \"arrow\"].includes(tool);\n  const handleToolChange = newTool => {\n    if (tool === newTool) {\n      setShowStyling(!showStyling);\n    } else {\n      setTool(newTool);\n      setShowStyling(true);\n    }\n  };\n  const [room, setRoom] = useState(null);\n  const [participants, setParticipants] = useState([]);\n  const [messages, setMessages] = useState([]);\n  const [sharedFiles, setSharedFiles] = useState([]);\n  const [activeTab, setActiveTab] = useState(\"chat\");\n  const [loadingFileUpload, setLoadingFileUpload] = useState(false);\n  const [screenStream, setScreenStream] = useState(null);\n  const screenVideoRef = useRef(null);\n  const [isSidebarOpen, setIsSidebarOpen] = useState(true);\n\n  // History & Dragging\n  const [history, setHistory] = useState([]);\n  const [historyIndex, setHistoryIndex] = useState(-1);\n  const [startPos, setStartPos] = useState({\n    x: 0,\n    y: 0\n  });\n  const [snapshot, setSnapshot] = useState(null);\n  useEffect(() => {\n    const fetchRoomDetails = async () => {\n      try {\n        const res = await roomService.getRoom(roomId);\n        setRoom(res.data.room);\n        setSharedFiles(res.data.room.sharedFiles || []);\n      } catch (err) {\n        toast.error(\"Failed to load workspace\");\n        navigate(\"/dashboard\");\n      }\n    };\n    fetchRoomDetails();\n    if (socket) {\n      socket.emit(\"join-room\", {\n        roomId,\n        userId: user._id,\n        userName: user.name\n      });\n      socket.on(\"user-joined\", data => toast.success(`${data.userName} joined`));\n      socket.on(\"online-users\", users => setParticipants(users));\n      socket.on(\"chat-message\", msg => setMessages(prev => [...prev, msg]));\n      socket.on(\"chat-history\", h => setMessages(h));\n      socket.on(\"drawing\", data => drawRemote(data));\n      socket.on(\"erase\", data => eraseRemote(data));\n      socket.on(\"board-cleared\", () => {\n        clearCanvasLocal();\n        setHistory([]);\n        setHistoryIndex(-1);\n      });\n      socket.on(\"canvas-state\", data => {\n        if (data) {\n          applyCanvasState(data);\n          setHistory([data]);\n          setHistoryIndex(0);\n        }\n      });\n      socket.on(\"undo\", state => applyCanvasState(state));\n      socket.on(\"redo\", state => applyCanvasState(state));\n    }\n    return () => {\n      if (socket) socket.emit(\"leave-room\", {\n        roomId,\n        userId: user._id,\n        userName: user.name\n      });\n    };\n  }, [roomId, socket, user, navigate]);\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const container = canvas.parentElement;\n    const ResizeCanvas = () => {\n      const rect = container.getBoundingClientRect();\n      const dpr = window.devicePixelRatio || 1;\n\n      // Save state\n      const tempCanvas = document.createElement('canvas');\n      const tempCtx = tempCanvas.getContext('2d');\n      tempCanvas.width = canvas.width;\n      tempCanvas.height = canvas.height;\n      tempCtx.drawImage(canvas, 0, 0);\n      canvas.width = rect.width * dpr;\n      canvas.height = rect.height * dpr;\n      canvas.style.width = `${rect.width}px`;\n      canvas.style.height = `${rect.height}px`;\n      const context = canvas.getContext(\"2d\");\n      context.scale(dpr, dpr);\n      context.lineCap = \"round\";\n      context.lineJoin = \"round\";\n      context.drawImage(tempCanvas, 0, 0, tempCanvas.width / dpr, tempCanvas.height / dpr, 0, 0, rect.width, rect.height);\n      contextRef.current = context;\n    };\n    const resizeObserver = new ResizeObserver(ResizeCanvas);\n    resizeObserver.observe(container);\n    ResizeCanvas();\n    return () => resizeObserver.disconnect();\n  }, []);\n  const applyCanvasState = state => {\n    if (!state) return clearCanvasLocal();\n    const image = new Image();\n    image.src = state;\n    image.onload = () => {\n      const canvas = canvasRef.current;\n      if (!canvas || !contextRef.current) return;\n      clearCanvasLocal();\n      contextRef.current.drawImage(image, 0, 0, canvas.width / (window.devicePixelRatio || 1), canvas.height / (window.devicePixelRatio || 1));\n    };\n  };\n  const clearCanvasLocal = () => {\n    const canvas = canvasRef.current;\n    if (!canvas || !contextRef.current) return;\n    const dpr = window.devicePixelRatio || 1;\n    contextRef.current.clearRect(0, 0, canvas.width / dpr, canvas.height / dpr);\n  };\n  const getMousePos = e => {\n    const canvas = canvasRef.current;\n    if (!canvas) return {\n      x: 0,\n      y: 0\n    };\n    const rect = canvas.getBoundingClientRect();\n    return {\n      x: e.clientX - rect.left,\n      y: e.clientY - rect.top\n    };\n  };\n  const startDrawing = e => {\n    const canvas = canvasRef.current;\n    if (!canvas || !contextRef.current || tool === 'pan') return;\n    const pos = getMousePos(e);\n    setStartPos(pos);\n    setIsDrawing(true);\n\n    // Take snapshot for shape preview\n    const tempCanvas = document.createElement('canvas');\n    tempCanvas.width = canvas.width;\n    tempCanvas.height = canvas.height;\n    tempCanvas.getContext('2d').drawImage(canvas, 0, 0);\n    setSnapshot(tempCanvas);\n    if (tool === \"pencil\" || tool === \"highlighter\" || tool === \"eraser\") {\n      contextRef.current.beginPath();\n      contextRef.current.moveTo(pos.x, pos.y);\n    }\n  };\n  const draw = e => {\n    if (!isDrawing || !contextRef.current) return;\n    const pos = getMousePos(e);\n    const ctx = contextRef.current;\n    const dpr = window.devicePixelRatio || 1;\n    ctx.lineWidth = size;\n    ctx.strokeStyle = color;\n    ctx.globalAlpha = tool === \"highlighter\" ? opacity * 0.4 : opacity;\n    ctx.setLineDash(strokeStyle === 'dashed' ? [10, 10] : []);\n    if (tool === \"pencil\" || tool === \"highlighter\") {\n      ctx.globalCompositeOperation = \"source-over\";\n      ctx.lineTo(pos.x, pos.y);\n      ctx.stroke();\n      socket.emit(\"drawing\", {\n        roomId,\n        drawingData: {\n          x: pos.x,\n          y: pos.y,\n          color,\n          size,\n          opacity: ctx.globalAlpha,\n          tool\n        }\n      });\n    } else if (tool === \"eraser\" || tool === \"precision-eraser\") {\n      ctx.globalCompositeOperation = \"destination-out\";\n      const eraserSize = tool === \"precision-eraser\" ? 4 : size * 2;\n      ctx.lineWidth = eraserSize;\n      ctx.lineTo(pos.x, pos.y);\n      ctx.stroke();\n      socket.emit(\"erase\", {\n        roomId,\n        eraseData: {\n          x: pos.x,\n          y: pos.y,\n          size: eraserSize\n        }\n      });\n    } else if ([\"rect\", \"circle\", \"line\", \"arrow\"].includes(tool)) {\n      // Restore snapshot for clean preview\n      if (!snapshot) return;\n      clearCanvasLocal();\n      ctx.drawImage(snapshot, 0, 0, snapshot.width / dpr, snapshot.height / dpr);\n      ctx.beginPath();\n      if (tool === \"line\") {\n        ctx.moveTo(startPos.x, startPos.y);\n        ctx.lineTo(pos.x, pos.y);\n      } else if (tool === \"rect\") {\n        if (fill) {\n          ctx.fillStyle = color;\n          ctx.fillRect(startPos.x, startPos.y, pos.x - startPos.x, pos.y - startPos.y);\n        }\n        ctx.strokeRect(startPos.x, startPos.y, pos.x - startPos.x, pos.y - startPos.y);\n      } else if (tool === \"circle\") {\n        const radius = Math.sqrt(Math.pow(pos.x - startPos.x, 2) + Math.pow(pos.y - startPos.y, 2));\n        ctx.arc(startPos.x, startPos.y, radius, 0, 2 * Math.PI);\n        if (fill) {\n          ctx.fillStyle = color;\n          ctx.fill();\n        }\n      } else if (tool === \"arrow\") {\n        drawArrow(ctx, startPos.x, startPos.y, pos.x, pos.y);\n      }\n      ctx.stroke();\n    }\n  };\n  const drawArrow = (ctx, fromx, fromy, tox, toy) => {\n    const headlen = size * 3;\n    const angle = Math.atan2(toy - fromy, tox - fromx);\n    ctx.moveTo(fromx, fromy);\n    ctx.lineTo(tox, toy);\n    ctx.lineTo(tox - headlen * Math.cos(angle - Math.PI / 6), toy - headlen * Math.sin(angle - Math.PI / 6));\n    ctx.moveTo(tox, toy);\n    ctx.lineTo(tox - headlen * Math.cos(angle + Math.PI / 6), toy - headlen * Math.sin(angle + Math.PI / 6));\n  };\n  const stopDrawing = () => {\n    const canvas = canvasRef.current;\n    if (!isDrawing || !canvas) return;\n    setIsDrawing(false);\n    setSnapshot(null);\n    const dataURL = canvas.toDataURL();\n    const newHistory = history.slice(0, historyIndex + 1);\n    newHistory.push(dataURL);\n    setHistory(newHistory);\n    setHistoryIndex(newHistory.length - 1);\n    socket.emit(\"save-canvas\", {\n      roomId,\n      canvasData: dataURL\n    });\n  };\n  const handleUndo = () => {\n    if (historyIndex > 0) {\n      const newIndex = historyIndex - 1;\n      const state = history[newIndex];\n      setHistoryIndex(newIndex);\n      applyCanvasState(state);\n      socket.emit(\"undo\", {\n        roomId,\n        canvasState: state\n      });\n      socket.emit(\"save-canvas\", {\n        roomId,\n        canvasData: state\n      });\n    }\n  };\n  const handleRedo = () => {\n    if (historyIndex < history.length - 1) {\n      const newIndex = historyIndex + 1;\n      const state = history[newIndex];\n      setHistoryIndex(newIndex);\n      applyCanvasState(state);\n      socket.emit(\"redo\", {\n        roomId,\n        canvasState: state\n      });\n      socket.emit(\"save-canvas\", {\n        roomId,\n        canvasData: state\n      });\n    }\n  };\n  const drawRemote = data => {\n    const {\n      x,\n      y,\n      color,\n      size,\n      opacity,\n      tool\n    } = data;\n    const ctx = contextRef.current;\n    const prevAlpha = ctx.globalAlpha;\n    const prevStroke = ctx.strokeStyle;\n    const prevWidth = ctx.lineWidth;\n    ctx.globalAlpha = opacity || 1;\n    ctx.strokeStyle = color;\n    ctx.lineWidth = size;\n    ctx.beginPath();\n    ctx.arc(x, y, size / 2, 0, Math.PI * 2);\n    ctx.fillStyle = color;\n    ctx.fill();\n    ctx.globalAlpha = prevAlpha;\n    ctx.strokeStyle = prevStroke;\n    ctx.lineWidth = prevWidth;\n  };\n  const eraseRemote = data => {\n    const {\n      x,\n      y,\n      size\n    } = data;\n    const ctx = contextRef.current;\n    const prevGCO = ctx.globalCompositeOperation;\n    ctx.globalCompositeOperation = \"destination-out\";\n    ctx.beginPath();\n    ctx.arc(x, y, size, 0, Math.PI * 2);\n    ctx.fill();\n    ctx.globalCompositeOperation = prevGCO;\n  };\n  const handleClearBoard = () => {\n    if (window.confirm(\"Clear all?\")) socket.emit(\"clear-board\", {\n      roomId,\n      userId: user._id\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"wb-layout-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"wb-header-miro\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-9 h-9 bg-violet-600 rounded-lg flex items-center justify-center cursor-pointer shadow-lg shadow-violet-200\",\n            onClick: () => navigate('/dashboard'),\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-white font-black text-lg\",\n              children: \"C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 332,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"font-bold text-slate-800 leading-tight text-sm truncate max-w-[150px]\",\n              children: (room === null || room === void 0 ? void 0 : room.roomName) || 'Untitled Board'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-[10px] text-slate-400 font-bold uppercase tracking-widest\",\n              children: [participants.length, \" online\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-px h-8 bg-slate-100\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 21\n        }, this), isDrawingTool && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-6 animate-in fade-in slide-in-from-left-4 duration-300\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-5 gap-1 pt-0.5\",\n              children: colors.slice(0, 5).map(c => /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setColor(c),\n                className: `w-4 h-4 rounded-full border border-slate-200 transition-all ${color === c ? 'ring-2 ring-violet-500 ring-offset-1 scale-110' : 'hover:scale-110'}`,\n                style: {\n                  backgroundColor: c\n                }\n              }, c, false, {\n                fileName: _jsxFileName,\n                lineNumber: 349,\n                columnNumber: 41\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 347,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-5 gap-1 pt-0.5\",\n              children: colors.slice(5).map(c => /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setColor(c),\n                className: `w-4 h-4 rounded-full border border-slate-200 transition-all ${color === c ? 'ring-2 ring-violet-500 ring-offset-1 scale-110' : 'hover:scale-110'}`,\n                style: {\n                  backgroundColor: c\n                }\n              }, c, false, {\n                fileName: _jsxFileName,\n                lineNumber: 359,\n                columnNumber: 41\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 346,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-px h-6 bg-slate-100\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 369,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-3 w-32\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-[9px] font-bold text-slate-400 uppercase tracking-widest\",\n              children: \"Size\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 373,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"range\",\n              min: \"1\",\n              max: \"40\",\n              value: size,\n              onChange: e => setSize(parseInt(e.target.value)),\n              className: \"w-full accent-violet-600 h-1 bg-slate-100 rounded-lg appearance-none cursor-pointer\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 374,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-[10px] font-mono font-bold text-slate-600 min-w-[20px]\",\n              children: size\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 379,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 372,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-px h-6 bg-slate-100\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 382,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-3 w-32\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-[9px] font-bold text-slate-400 uppercase tracking-widest\",\n              children: \"Opacity\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 386,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"range\",\n              min: \"0.1\",\n              max: \"1\",\n              step: \"0.1\",\n              value: opacity,\n              onChange: e => setOpacity(parseFloat(e.target.value)),\n              className: \"w-full accent-violet-600 h-1 bg-slate-100 rounded-lg appearance-none cursor-pointer\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 387,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-[10px] font-mono font-bold text-slate-600 min-w-[25px]\",\n              children: [Math.round(opacity * 100), \"%\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 392,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-secondary-miro\",\n          onClick: () => {\n            navigator.clipboard.writeText(window.location.href);\n            toast.success(\"Link copied!\");\n          },\n          children: \"Invite Collaborators\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 399,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-primary-miro\",\n          children: \"Share Screen\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 403,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-px h-6 bg-slate-200 mx-1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"tool-button\",\n          onClick: () => setIsSidebarOpen(!isSidebarOpen),\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-lg\",\n            children: \"\\uD83D\\uDCAC\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 406,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"aside\", {\n      className: \"wb-left-panel\",\n      children: /*#__PURE__*/_jsxDEV(Toolbar, {\n        activeTool: tool,\n        setTool: handleToolChange,\n        isHost: user._id === (room === null || room === void 0 ? void 0 : room.host),\n        onClear: handleClearBoard,\n        onUndo: handleUndo,\n        onRedo: handleRedo,\n        onDelete: () => {}\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 412,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"wb-viewport\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"canvas-miro shadow-2xl rounded-sm border border-slate-100 overflow-hidden\",\n        children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          onMouseDown: startDrawing,\n          onMouseMove: draw,\n          onMouseUp: stopDrawing,\n          onMouseOut: stopDrawing\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 426,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(StylingPanel, {\n        tool: tool,\n        visible: showStyling,\n        color: color,\n        setColor: setColor,\n        size: size,\n        setSize: setSize,\n        opacity: opacity,\n        setOpacity: setOpacity,\n        strokeStyle: strokeStyle,\n        setStrokeStyle: setStrokeStyle,\n        fill: fill,\n        setFill: setFill\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 437,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute bottom-6 right-6 flex items-center gap-2 bg-white p-1 rounded-xl shadow-lg border border-slate-200\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"w-8 h-8 hover:bg-slate-50 rounded-lg text-xs font-bold text-slate-600\",\n          children: \"100%\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 449,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-px h-4 bg-slate-100\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"w-8 h-8 hover:bg-slate-50 rounded-lg\",\n          children: \"\\uD83D\\uDDA5\\uFE0F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 451,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 448,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"aside\", {\n      className: `wb-right-panel ${isSidebarOpen ? 'open' : ''}`,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col h-full\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex p-2 bg-slate-50 border-b border-slate-200\",\n          children: ['chat', 'files', 'users'].map(tab => /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setActiveTab(tab),\n            className: `flex-1 py-1.5 rounded-lg text-[10px] font-bold transition-all uppercase tracking-widest\n                                          ${activeTab === tab ? \"bg-white text-violet-700 shadow-sm border border-slate-200\" : \"text-slate-500 hover:text-slate-700\"}`,\n            children: tab\n          }, tab, false, {\n            fileName: _jsxFileName,\n            lineNumber: 460,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 458,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 overflow-hidden\",\n          children: activeTab === \"chat\" ? /*#__PURE__*/_jsxDEV(Chat, {\n            messages: messages,\n            onSendMessage: txt => socket.emit(\"chat-message\", {\n              roomId,\n              message: txt,\n              userId: user._id,\n              userName: user.name\n            }),\n            currentUser: user\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 472,\n            columnNumber: 29\n          }, this) : activeTab === \"files\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"btn-secondary-miro w-full flex justify-center cursor-pointer text-xs mb-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Share Asset\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 476,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"file\",\n                className: \"hidden\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 477,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 475,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-2\",\n              children: sharedFiles.map((f, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"p-3 bg-slate-50 rounded-lg border border-slate-100 flex items-center justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-xs font-medium truncate max-w-[150px]\",\n                  children: f.fileName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 482,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-violet-600\",\n                  children: \"\\u2B07\\uFE0F\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 483,\n                  columnNumber: 45\n                }, this)]\n              }, i, true, {\n                fileName: _jsxFileName,\n                lineNumber: 481,\n                columnNumber: 41\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 479,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 474,\n            columnNumber: 29\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-4 space-y-2\",\n            children: participants.map((p, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-3 p-2 hover:bg-slate-50 rounded-lg\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-6 h-6 rounded-full bg-violet-100 flex items-center justify-center text-[10px] font-bold text-violet-700\",\n                children: p.userName[0]\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 492,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xs font-medium text-slate-700\",\n                children: p.userName\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 493,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-1.5 h-1.5 rounded-full bg-green-500 ml-auto\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 494,\n                columnNumber: 41\n              }, this)]\n            }, i, true, {\n              fileName: _jsxFileName,\n              lineNumber: 491,\n              columnNumber: 37\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 489,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 470,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 457,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 456,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 326,\n    columnNumber: 9\n  }, this);\n};\n_s(WhiteboardRoom, \"udCJrmxbU/uYFYlfFsPiDWzBRds=\", false, function () {\n  return [useParams, useNavigate, useAuth, useSocket];\n});\n_c = WhiteboardRoom;\nexport default WhiteboardRoom;\nvar _c;\n$RefreshReg$(_c, \"WhiteboardRoom\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useParams","useNavigate","useAuth","useSocket","roomService","Toolbar","Chat","StylingPanel","toast","jsxDEV","_jsxDEV","WhiteboardRoom","_s","roomId","navigate","user","socket","canvasRef","contextRef","isDrawing","setIsDrawing","tool","setTool","showStyling","setShowStyling","color","setColor","size","setSize","opacity","setOpacity","strokeStyle","setStrokeStyle","fill","setFill","colors","isDrawingTool","includes","handleToolChange","newTool","room","setRoom","participants","setParticipants","messages","setMessages","sharedFiles","setSharedFiles","activeTab","setActiveTab","loadingFileUpload","setLoadingFileUpload","screenStream","setScreenStream","screenVideoRef","isSidebarOpen","setIsSidebarOpen","history","setHistory","historyIndex","setHistoryIndex","startPos","setStartPos","x","y","snapshot","setSnapshot","fetchRoomDetails","res","getRoom","data","err","error","emit","userId","_id","userName","name","on","success","users","msg","prev","h","drawRemote","eraseRemote","clearCanvasLocal","applyCanvasState","state","canvas","current","container","parentElement","ResizeCanvas","rect","getBoundingClientRect","dpr","window","devicePixelRatio","tempCanvas","document","createElement","tempCtx","getContext","width","height","drawImage","style","context","scale","lineCap","lineJoin","resizeObserver","ResizeObserver","observe","disconnect","image","Image","src","onload","clearRect","getMousePos","e","clientX","left","clientY","top","startDrawing","pos","beginPath","moveTo","draw","ctx","lineWidth","globalAlpha","setLineDash","globalCompositeOperation","lineTo","stroke","drawingData","eraserSize","eraseData","fillStyle","fillRect","strokeRect","radius","Math","sqrt","pow","arc","PI","drawArrow","fromx","fromy","tox","toy","headlen","angle","atan2","cos","sin","stopDrawing","dataURL","toDataURL","newHistory","slice","push","length","canvasData","handleUndo","newIndex","canvasState","handleRedo","prevAlpha","prevStroke","prevWidth","prevGCO","handleClearBoard","confirm","className","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","roomName","map","c","backgroundColor","type","min","max","value","onChange","parseInt","target","step","parseFloat","round","navigator","clipboard","writeText","location","href","activeTool","isHost","host","onClear","onUndo","onRedo","onDelete","ref","onMouseDown","onMouseMove","onMouseUp","onMouseOut","visible","tab","onSendMessage","txt","message","currentUser","f","i","p","_c","$RefreshReg$"],"sources":["D:/CapstoneProject/whiteboard-app/frontend/src/pages/WhiteboardRoom.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport { useParams, useNavigate } from \"react-router-dom\";\r\nimport { useAuth } from \"../context/AuthContext\";\r\nimport { useSocket } from \"../context/SocketContext\";\r\nimport { roomService } from \"../services/api\";\r\nimport Toolbar from \"../components/Toolbar\";\r\nimport Chat from \"../components/Chat\";\r\nimport StylingPanel from \"../components/StylingPanel\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nconst WhiteboardRoom = () => {\r\n    const { roomId } = useParams();\r\n    const navigate = useNavigate();\r\n    const { user } = useAuth();\r\n    const { socket } = useSocket();\r\n\r\n    const canvasRef = useRef(null);\r\n    const contextRef = useRef(null);\r\n    const [isDrawing, setIsDrawing] = useState(false);\r\n\r\n    // Tools & Styling\r\n    const [tool, setTool] = useState(\"pencil\");\r\n    const [showStyling, setShowStyling] = useState(true);\r\n    const [color, setColor] = useState(\"#000000\");\r\n    const [size, setSize] = useState(4);\r\n    const [opacity, setOpacity] = useState(1);\r\n    const [strokeStyle, setStrokeStyle] = useState('solid');\r\n    const [fill, setFill] = useState(false);\r\n\r\n    const colors = [\r\n        \"#000000\", \"#475569\", \"#dc2626\", \"#ea580c\", \"#d97706\",\r\n        \"#65a30d\", \"#0891b2\", \"#2563eb\", \"#7c3aed\", \"#db2777\"\r\n    ];\r\n\r\n    const isDrawingTool = [\"pencil\", \"highlighter\", \"rect\", \"circle\", \"line\", \"arrow\"].includes(tool);\r\n\r\n    const handleToolChange = (newTool) => {\r\n        if (tool === newTool) {\r\n            setShowStyling(!showStyling);\r\n        } else {\r\n            setTool(newTool);\r\n            setShowStyling(true);\r\n        }\r\n    };\r\n\r\n    const [room, setRoom] = useState(null);\r\n    const [participants, setParticipants] = useState([]);\r\n    const [messages, setMessages] = useState([]);\r\n    const [sharedFiles, setSharedFiles] = useState([]);\r\n    const [activeTab, setActiveTab] = useState(\"chat\");\r\n    const [loadingFileUpload, setLoadingFileUpload] = useState(false);\r\n    const [screenStream, setScreenStream] = useState(null);\r\n    const screenVideoRef = useRef(null);\r\n    const [isSidebarOpen, setIsSidebarOpen] = useState(true);\r\n\r\n    // History & Dragging\r\n    const [history, setHistory] = useState([]);\r\n    const [historyIndex, setHistoryIndex] = useState(-1);\r\n    const [startPos, setStartPos] = useState({ x: 0, y: 0 });\r\n    const [snapshot, setSnapshot] = useState(null);\r\n\r\n    useEffect(() => {\r\n        const fetchRoomDetails = async () => {\r\n            try {\r\n                const res = await roomService.getRoom(roomId);\r\n                setRoom(res.data.room);\r\n                setSharedFiles(res.data.room.sharedFiles || []);\r\n            } catch (err) {\r\n                toast.error(\"Failed to load workspace\");\r\n                navigate(\"/dashboard\");\r\n            }\r\n        };\r\n\r\n        fetchRoomDetails();\r\n\r\n        if (socket) {\r\n            socket.emit(\"join-room\", { roomId, userId: user._id, userName: user.name });\r\n\r\n            socket.on(\"user-joined\", (data) => toast.success(`${data.userName} joined`));\r\n            socket.on(\"online-users\", (users) => setParticipants(users));\r\n            socket.on(\"chat-message\", (msg) => setMessages((prev) => [...prev, msg]));\r\n            socket.on(\"chat-history\", (h) => setMessages(h));\r\n            socket.on(\"drawing\", (data) => drawRemote(data));\r\n            socket.on(\"erase\", (data) => eraseRemote(data));\r\n            socket.on(\"board-cleared\", () => {\r\n                clearCanvasLocal();\r\n                setHistory([]);\r\n                setHistoryIndex(-1);\r\n            });\r\n            socket.on(\"canvas-state\", (data) => {\r\n                if (data) {\r\n                    applyCanvasState(data);\r\n                    setHistory([data]);\r\n                    setHistoryIndex(0);\r\n                }\r\n            });\r\n            socket.on(\"undo\", (state) => applyCanvasState(state));\r\n            socket.on(\"redo\", (state) => applyCanvasState(state));\r\n        }\r\n\r\n        return () => {\r\n            if (socket) socket.emit(\"leave-room\", { roomId, userId: user._id, userName: user.name });\r\n        };\r\n    }, [roomId, socket, user, navigate]);\r\n\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current;\r\n        const container = canvas.parentElement;\r\n\r\n        const ResizeCanvas = () => {\r\n            const rect = container.getBoundingClientRect();\r\n            const dpr = window.devicePixelRatio || 1;\r\n\r\n            // Save state\r\n            const tempCanvas = document.createElement('canvas');\r\n            const tempCtx = tempCanvas.getContext('2d');\r\n            tempCanvas.width = canvas.width;\r\n            tempCanvas.height = canvas.height;\r\n            tempCtx.drawImage(canvas, 0, 0);\r\n\r\n            canvas.width = rect.width * dpr;\r\n            canvas.height = rect.height * dpr;\r\n            canvas.style.width = `${rect.width}px`;\r\n            canvas.style.height = `${rect.height}px`;\r\n\r\n            const context = canvas.getContext(\"2d\");\r\n            context.scale(dpr, dpr);\r\n            context.lineCap = \"round\";\r\n            context.lineJoin = \"round\";\r\n            context.drawImage(tempCanvas, 0, 0, tempCanvas.width / dpr, tempCanvas.height / dpr, 0, 0, rect.width, rect.height);\r\n            contextRef.current = context;\r\n        };\r\n\r\n        const resizeObserver = new ResizeObserver(ResizeCanvas);\r\n        resizeObserver.observe(container);\r\n        ResizeCanvas();\r\n\r\n        return () => resizeObserver.disconnect();\r\n    }, []);\r\n\r\n    const applyCanvasState = (state) => {\r\n        if (!state) return clearCanvasLocal();\r\n        const image = new Image();\r\n        image.src = state;\r\n        image.onload = () => {\r\n            const canvas = canvasRef.current;\r\n            if (!canvas || !contextRef.current) return;\r\n            clearCanvasLocal();\r\n            contextRef.current.drawImage(image, 0, 0, canvas.width / (window.devicePixelRatio || 1), canvas.height / (window.devicePixelRatio || 1));\r\n        };\r\n    };\r\n\r\n    const clearCanvasLocal = () => {\r\n        const canvas = canvasRef.current;\r\n        if (!canvas || !contextRef.current) return;\r\n        const dpr = window.devicePixelRatio || 1;\r\n        contextRef.current.clearRect(0, 0, canvas.width / dpr, canvas.height / dpr);\r\n    };\r\n\r\n    const getMousePos = (e) => {\r\n        const canvas = canvasRef.current;\r\n        if (!canvas) return { x: 0, y: 0 };\r\n        const rect = canvas.getBoundingClientRect();\r\n        return {\r\n            x: e.clientX - rect.left,\r\n            y: e.clientY - rect.top\r\n        };\r\n    };\r\n\r\n    const startDrawing = (e) => {\r\n        const canvas = canvasRef.current;\r\n        if (!canvas || !contextRef.current || tool === 'pan') return;\r\n\r\n        const pos = getMousePos(e);\r\n        setStartPos(pos);\r\n        setIsDrawing(true);\r\n\r\n        // Take snapshot for shape preview\r\n        const tempCanvas = document.createElement('canvas');\r\n        tempCanvas.width = canvas.width;\r\n        tempCanvas.height = canvas.height;\r\n        tempCanvas.getContext('2d').drawImage(canvas, 0, 0);\r\n        setSnapshot(tempCanvas);\r\n\r\n        if (tool === \"pencil\" || tool === \"highlighter\" || tool === \"eraser\") {\r\n            contextRef.current.beginPath();\r\n            contextRef.current.moveTo(pos.x, pos.y);\r\n        }\r\n    };\r\n\r\n    const draw = (e) => {\r\n        if (!isDrawing || !contextRef.current) return;\r\n        const pos = getMousePos(e);\r\n        const ctx = contextRef.current;\r\n        const dpr = window.devicePixelRatio || 1;\r\n\r\n        ctx.lineWidth = size;\r\n        ctx.strokeStyle = color;\r\n        ctx.globalAlpha = tool === \"highlighter\" ? (opacity * 0.4) : opacity;\r\n        ctx.setLineDash(strokeStyle === 'dashed' ? [10, 10] : []);\r\n\r\n        if (tool === \"pencil\" || tool === \"highlighter\") {\r\n            ctx.globalCompositeOperation = \"source-over\";\r\n            ctx.lineTo(pos.x, pos.y);\r\n            ctx.stroke();\r\n            socket.emit(\"drawing\", { roomId, drawingData: { x: pos.x, y: pos.y, color, size, opacity: ctx.globalAlpha, tool } });\r\n        } else if (tool === \"eraser\" || tool === \"precision-eraser\") {\r\n            ctx.globalCompositeOperation = \"destination-out\";\r\n            const eraserSize = tool === \"precision-eraser\" ? 4 : size * 2;\r\n            ctx.lineWidth = eraserSize;\r\n            ctx.lineTo(pos.x, pos.y);\r\n            ctx.stroke();\r\n            socket.emit(\"erase\", { roomId, eraseData: { x: pos.x, y: pos.y, size: eraserSize } });\r\n        } else if ([\"rect\", \"circle\", \"line\", \"arrow\"].includes(tool)) {\r\n            // Restore snapshot for clean preview\r\n            if (!snapshot) return;\r\n            clearCanvasLocal();\r\n            ctx.drawImage(snapshot, 0, 0, snapshot.width / dpr, snapshot.height / dpr);\r\n\r\n            ctx.beginPath();\r\n            if (tool === \"line\") {\r\n                ctx.moveTo(startPos.x, startPos.y);\r\n                ctx.lineTo(pos.x, pos.y);\r\n            } else if (tool === \"rect\") {\r\n                if (fill) {\r\n                    ctx.fillStyle = color;\r\n                    ctx.fillRect(startPos.x, startPos.y, pos.x - startPos.x, pos.y - startPos.y);\r\n                }\r\n                ctx.strokeRect(startPos.x, startPos.y, pos.x - startPos.x, pos.y - startPos.y);\r\n            } else if (tool === \"circle\") {\r\n                const radius = Math.sqrt(Math.pow(pos.x - startPos.x, 2) + Math.pow(pos.y - startPos.y, 2));\r\n                ctx.arc(startPos.x, startPos.y, radius, 0, 2 * Math.PI);\r\n                if (fill) {\r\n                    ctx.fillStyle = color;\r\n                    ctx.fill();\r\n                }\r\n            } else if (tool === \"arrow\") {\r\n                drawArrow(ctx, startPos.x, startPos.y, pos.x, pos.y);\r\n            }\r\n            ctx.stroke();\r\n        }\r\n    };\r\n\r\n    const drawArrow = (ctx, fromx, fromy, tox, toy) => {\r\n        const headlen = size * 3;\r\n        const angle = Math.atan2(toy - fromy, tox - fromx);\r\n        ctx.moveTo(fromx, fromy);\r\n        ctx.lineTo(tox, toy);\r\n        ctx.lineTo(tox - headlen * Math.cos(angle - Math.PI / 6), toy - headlen * Math.sin(angle - Math.PI / 6));\r\n        ctx.moveTo(tox, toy);\r\n        ctx.lineTo(tox - headlen * Math.cos(angle + Math.PI / 6), toy - headlen * Math.sin(angle + Math.PI / 6));\r\n    };\r\n\r\n    const stopDrawing = () => {\r\n        const canvas = canvasRef.current;\r\n        if (!isDrawing || !canvas) return;\r\n        setIsDrawing(false);\r\n        setSnapshot(null);\r\n\r\n        const dataURL = canvas.toDataURL();\r\n        const newHistory = history.slice(0, historyIndex + 1);\r\n        newHistory.push(dataURL);\r\n        setHistory(newHistory);\r\n        setHistoryIndex(newHistory.length - 1);\r\n        socket.emit(\"save-canvas\", { roomId, canvasData: dataURL });\r\n    };\r\n\r\n    const handleUndo = () => {\r\n        if (historyIndex > 0) {\r\n            const newIndex = historyIndex - 1;\r\n            const state = history[newIndex];\r\n            setHistoryIndex(newIndex);\r\n            applyCanvasState(state);\r\n            socket.emit(\"undo\", { roomId, canvasState: state });\r\n            socket.emit(\"save-canvas\", { roomId, canvasData: state });\r\n        }\r\n    };\r\n\r\n    const handleRedo = () => {\r\n        if (historyIndex < history.length - 1) {\r\n            const newIndex = historyIndex + 1;\r\n            const state = history[newIndex];\r\n            setHistoryIndex(newIndex);\r\n            applyCanvasState(state);\r\n            socket.emit(\"redo\", { roomId, canvasState: state });\r\n            socket.emit(\"save-canvas\", { roomId, canvasData: state });\r\n        }\r\n    };\r\n\r\n    const drawRemote = (data) => {\r\n        const { x, y, color, size, opacity, tool } = data;\r\n        const ctx = contextRef.current;\r\n        const prevAlpha = ctx.globalAlpha;\r\n        const prevStroke = ctx.strokeStyle;\r\n        const prevWidth = ctx.lineWidth;\r\n\r\n        ctx.globalAlpha = opacity || 1;\r\n        ctx.strokeStyle = color;\r\n        ctx.lineWidth = size;\r\n        ctx.beginPath();\r\n        ctx.arc(x, y, size / 2, 0, Math.PI * 2);\r\n        ctx.fillStyle = color;\r\n        ctx.fill();\r\n\r\n        ctx.globalAlpha = prevAlpha;\r\n        ctx.strokeStyle = prevStroke;\r\n        ctx.lineWidth = prevWidth;\r\n    };\r\n\r\n    const eraseRemote = (data) => {\r\n        const { x, y, size } = data;\r\n        const ctx = contextRef.current;\r\n        const prevGCO = ctx.globalCompositeOperation;\r\n        ctx.globalCompositeOperation = \"destination-out\";\r\n        ctx.beginPath();\r\n        ctx.arc(x, y, size, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.globalCompositeOperation = prevGCO;\r\n    };\r\n\r\n    const handleClearBoard = () => {\r\n        if (window.confirm(\"Clear all?\")) socket.emit(\"clear-board\", { roomId, userId: user._id });\r\n    };\r\n\r\n    return (\r\n        <div className=\"wb-layout-container\">\r\n            {/* Header */}\r\n            <header className=\"wb-header-miro\">\r\n                <div className=\"flex items-center gap-6\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"w-9 h-9 bg-violet-600 rounded-lg flex items-center justify-center cursor-pointer shadow-lg shadow-violet-200\" onClick={() => navigate('/dashboard')}>\r\n                            <span className=\"text-white font-black text-lg\">C</span>\r\n                        </div>\r\n                        <div>\r\n                            <h1 className=\"font-bold text-slate-800 leading-tight text-sm truncate max-w-[150px]\">{room?.roomName || 'Untitled Board'}</h1>\r\n                            <span className=\"text-[10px] text-slate-400 font-bold uppercase tracking-widest\">{participants.length} online</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"w-px h-8 bg-slate-100\"></div>\r\n\r\n                    {/* Navbar Styling Controls */}\r\n                    {isDrawingTool && (\r\n                        <div className=\"flex items-center gap-6 animate-in fade-in slide-in-from-left-4 duration-300\">\r\n                            {/* Color Picker */}\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <div className=\"grid grid-cols-5 gap-1 pt-0.5\">\r\n                                    {colors.slice(0, 5).map(c => (\r\n                                        <button\r\n                                            key={c}\r\n                                            onClick={() => setColor(c)}\r\n                                            className={`w-4 h-4 rounded-full border border-slate-200 transition-all ${color === c ? 'ring-2 ring-violet-500 ring-offset-1 scale-110' : 'hover:scale-110'}`}\r\n                                            style={{ backgroundColor: c }}\r\n                                        />\r\n                                    ))}\r\n                                </div>\r\n                                <div className=\"grid grid-cols-5 gap-1 pt-0.5\">\r\n                                    {colors.slice(5).map(c => (\r\n                                        <button\r\n                                            key={c}\r\n                                            onClick={() => setColor(c)}\r\n                                            className={`w-4 h-4 rounded-full border border-slate-200 transition-all ${color === c ? 'ring-2 ring-violet-500 ring-offset-1 scale-110' : 'hover:scale-110'}`}\r\n                                            style={{ backgroundColor: c }}\r\n                                        />\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"w-px h-6 bg-slate-100\"></div>\r\n\r\n                            {/* Size Slider */}\r\n                            <div className=\"flex items-center gap-3 w-32\">\r\n                                <span className=\"text-[9px] font-bold text-slate-400 uppercase tracking-widest\">Size</span>\r\n                                <input\r\n                                    type=\"range\" min=\"1\" max=\"40\" value={size}\r\n                                    onChange={(e) => setSize(parseInt(e.target.value))}\r\n                                    className=\"w-full accent-violet-600 h-1 bg-slate-100 rounded-lg appearance-none cursor-pointer\"\r\n                                />\r\n                                <span className=\"text-[10px] font-mono font-bold text-slate-600 min-w-[20px]\">{size}</span>\r\n                            </div>\r\n\r\n                            <div className=\"w-px h-6 bg-slate-100\"></div>\r\n\r\n                            {/* Opacity Control */}\r\n                            <div className=\"flex items-center gap-3 w-32\">\r\n                                <span className=\"text-[9px] font-bold text-slate-400 uppercase tracking-widest\">Opacity</span>\r\n                                <input\r\n                                    type=\"range\" min=\"0.1\" max=\"1\" step=\"0.1\" value={opacity}\r\n                                    onChange={(e) => setOpacity(parseFloat(e.target.value))}\r\n                                    className=\"w-full accent-violet-600 h-1 bg-slate-100 rounded-lg appearance-none cursor-pointer\"\r\n                                />\r\n                                <span className=\"text-[10px] font-mono font-bold text-slate-600 min-w-[25px]\">{Math.round(opacity * 100)}%</span>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-3\">\r\n                    <button className=\"btn-secondary-miro\" onClick={() => {\r\n                        navigator.clipboard.writeText(window.location.href);\r\n                        toast.success(\"Link copied!\");\r\n                    }}>Invite Collaborators</button>\r\n                    <button className=\"btn-primary-miro\">Share Screen</button>\r\n                    <div className=\"w-px h-6 bg-slate-200 mx-1\"></div>\r\n                    <button className=\"tool-button\" onClick={() => setIsSidebarOpen(!isSidebarOpen)}>\r\n                        <span className=\"text-lg\"></span>\r\n                    </button>\r\n                </div>\r\n            </header>\r\n\r\n            {/* Left Sidebar */}\r\n            <aside className=\"wb-left-panel\">\r\n                <Toolbar\r\n                    activeTool={tool}\r\n                    setTool={handleToolChange}\r\n                    isHost={user._id === room?.host}\r\n                    onClear={handleClearBoard}\r\n                    onUndo={handleUndo}\r\n                    onRedo={handleRedo}\r\n                    onDelete={() => { }}\r\n                />\r\n            </aside>\r\n\r\n            {/* Viewport & Canvas */}\r\n            <main className=\"wb-viewport\">\r\n                <div className=\"canvas-miro shadow-2xl rounded-sm border border-slate-100 overflow-hidden\">\r\n                    <canvas\r\n                        ref={canvasRef}\r\n                        onMouseDown={startDrawing}\r\n                        onMouseMove={draw}\r\n                        onMouseUp={stopDrawing}\r\n                        onMouseOut={stopDrawing}\r\n                    />\r\n                </div>\r\n\r\n                {/* Floating Styling Panel */}\r\n                <StylingPanel\r\n                    tool={tool}\r\n                    visible={showStyling}\r\n                    color={color} setColor={setColor}\r\n                    size={size} setSize={setSize}\r\n                    opacity={opacity} setOpacity={setOpacity}\r\n                    strokeStyle={strokeStyle} setStrokeStyle={setStrokeStyle}\r\n                    fill={fill} setFill={setFill}\r\n                />\r\n\r\n                {/* Zoom Controls Overlay */}\r\n                <div className=\"absolute bottom-6 right-6 flex items-center gap-2 bg-white p-1 rounded-xl shadow-lg border border-slate-200\">\r\n                    <button className=\"w-8 h-8 hover:bg-slate-50 rounded-lg text-xs font-bold text-slate-600\">100%</button>\r\n                    <div className=\"w-px h-4 bg-slate-100\"></div>\r\n                    <button className=\"w-8 h-8 hover:bg-slate-50 rounded-lg\"></button>\r\n                </div>\r\n            </main>\r\n\r\n            {/* Right Sidebar */}\r\n            <aside className={`wb-right-panel ${isSidebarOpen ? 'open' : ''}`}>\r\n                <div className=\"flex flex-col h-full\">\r\n                    <div className=\"flex p-2 bg-slate-50 border-b border-slate-200\">\r\n                        {['chat', 'files', 'users'].map((tab) => (\r\n                            <button\r\n                                key={tab}\r\n                                onClick={() => setActiveTab(tab)}\r\n                                className={`flex-1 py-1.5 rounded-lg text-[10px] font-bold transition-all uppercase tracking-widest\r\n                                          ${activeTab === tab ? \"bg-white text-violet-700 shadow-sm border border-slate-200\" : \"text-slate-500 hover:text-slate-700\"}`}\r\n                            >\r\n                                {tab}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                    <div className=\"flex-1 overflow-hidden\">\r\n                        {activeTab === \"chat\" ? (\r\n                            <Chat messages={messages} onSendMessage={(txt) => socket.emit(\"chat-message\", { roomId, message: txt, userId: user._id, userName: user.name })} currentUser={user} />\r\n                        ) : activeTab === \"files\" ? (\r\n                            <div className=\"p-4\">\r\n                                <label className=\"btn-secondary-miro w-full flex justify-center cursor-pointer text-xs mb-4\">\r\n                                    <span>Share Asset</span>\r\n                                    <input type=\"file\" className=\"hidden\" />\r\n                                </label>\r\n                                <div className=\"space-y-2\">\r\n                                    {sharedFiles.map((f, i) => (\r\n                                        <div key={i} className=\"p-3 bg-slate-50 rounded-lg border border-slate-100 flex items-center justify-between\">\r\n                                            <span className=\"text-xs font-medium truncate max-w-[150px]\">{f.fileName}</span>\r\n                                            <span className=\"text-violet-600\"></span>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"p-4 space-y-2\">\r\n                                {participants.map((p, i) => (\r\n                                    <div key={i} className=\"flex items-center gap-3 p-2 hover:bg-slate-50 rounded-lg\">\r\n                                        <div className=\"w-6 h-6 rounded-full bg-violet-100 flex items-center justify-center text-[10px] font-bold text-violet-700\">{p.userName[0]}</div>\r\n                                        <span className=\"text-xs font-medium text-slate-700\">{p.userName}</span>\r\n                                        <div className=\"w-1.5 h-1.5 rounded-full bg-green-500 ml-auto\"></div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </aside>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default WhiteboardRoom;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AAC1D,SAASC,SAAS,EAAEC,WAAW,QAAQ,kBAAkB;AACzD,SAASC,OAAO,QAAQ,wBAAwB;AAChD,SAASC,SAAS,QAAQ,0BAA0B;AACpD,SAASC,WAAW,QAAQ,iBAAiB;AAC7C,OAAOC,OAAO,MAAM,uBAAuB;AAC3C,OAAOC,IAAI,MAAM,oBAAoB;AACrC,OAAOC,YAAY,MAAM,4BAA4B;AACrD,OAAOC,KAAK,MAAM,iBAAiB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEpC,MAAMC,cAAc,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACzB,MAAM;IAAEC;EAAO,CAAC,GAAGb,SAAS,CAAC,CAAC;EAC9B,MAAMc,QAAQ,GAAGb,WAAW,CAAC,CAAC;EAC9B,MAAM;IAAEc;EAAK,CAAC,GAAGb,OAAO,CAAC,CAAC;EAC1B,MAAM;IAAEc;EAAO,CAAC,GAAGb,SAAS,CAAC,CAAC;EAE9B,MAAMc,SAAS,GAAGnB,MAAM,CAAC,IAAI,CAAC;EAC9B,MAAMoB,UAAU,GAAGpB,MAAM,CAAC,IAAI,CAAC;EAC/B,MAAM,CAACqB,SAAS,EAAEC,YAAY,CAAC,GAAGrB,QAAQ,CAAC,KAAK,CAAC;;EAEjD;EACA,MAAM,CAACsB,IAAI,EAAEC,OAAO,CAAC,GAAGvB,QAAQ,CAAC,QAAQ,CAAC;EAC1C,MAAM,CAACwB,WAAW,EAAEC,cAAc,CAAC,GAAGzB,QAAQ,CAAC,IAAI,CAAC;EACpD,MAAM,CAAC0B,KAAK,EAAEC,QAAQ,CAAC,GAAG3B,QAAQ,CAAC,SAAS,CAAC;EAC7C,MAAM,CAAC4B,IAAI,EAAEC,OAAO,CAAC,GAAG7B,QAAQ,CAAC,CAAC,CAAC;EACnC,MAAM,CAAC8B,OAAO,EAAEC,UAAU,CAAC,GAAG/B,QAAQ,CAAC,CAAC,CAAC;EACzC,MAAM,CAACgC,WAAW,EAAEC,cAAc,CAAC,GAAGjC,QAAQ,CAAC,OAAO,CAAC;EACvD,MAAM,CAACkC,IAAI,EAAEC,OAAO,CAAC,GAAGnC,QAAQ,CAAC,KAAK,CAAC;EAEvC,MAAMoC,MAAM,GAAG,CACX,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EACrD,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,CACxD;EAED,MAAMC,aAAa,GAAG,CAAC,QAAQ,EAAE,aAAa,EAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,CAAC,CAACC,QAAQ,CAAChB,IAAI,CAAC;EAEjG,MAAMiB,gBAAgB,GAAIC,OAAO,IAAK;IAClC,IAAIlB,IAAI,KAAKkB,OAAO,EAAE;MAClBf,cAAc,CAAC,CAACD,WAAW,CAAC;IAChC,CAAC,MAAM;MACHD,OAAO,CAACiB,OAAO,CAAC;MAChBf,cAAc,CAAC,IAAI,CAAC;IACxB;EACJ,CAAC;EAED,MAAM,CAACgB,IAAI,EAAEC,OAAO,CAAC,GAAG1C,QAAQ,CAAC,IAAI,CAAC;EACtC,MAAM,CAAC2C,YAAY,EAAEC,eAAe,CAAC,GAAG5C,QAAQ,CAAC,EAAE,CAAC;EACpD,MAAM,CAAC6C,QAAQ,EAAEC,WAAW,CAAC,GAAG9C,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAAC+C,WAAW,EAAEC,cAAc,CAAC,GAAGhD,QAAQ,CAAC,EAAE,CAAC;EAClD,MAAM,CAACiD,SAAS,EAAEC,YAAY,CAAC,GAAGlD,QAAQ,CAAC,MAAM,CAAC;EAClD,MAAM,CAACmD,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGpD,QAAQ,CAAC,KAAK,CAAC;EACjE,MAAM,CAACqD,YAAY,EAAEC,eAAe,CAAC,GAAGtD,QAAQ,CAAC,IAAI,CAAC;EACtD,MAAMuD,cAAc,GAAGxD,MAAM,CAAC,IAAI,CAAC;EACnC,MAAM,CAACyD,aAAa,EAAEC,gBAAgB,CAAC,GAAGzD,QAAQ,CAAC,IAAI,CAAC;;EAExD;EACA,MAAM,CAAC0D,OAAO,EAAEC,UAAU,CAAC,GAAG3D,QAAQ,CAAC,EAAE,CAAC;EAC1C,MAAM,CAAC4D,YAAY,EAAEC,eAAe,CAAC,GAAG7D,QAAQ,CAAC,CAAC,CAAC,CAAC;EACpD,MAAM,CAAC8D,QAAQ,EAAEC,WAAW,CAAC,GAAG/D,QAAQ,CAAC;IAAEgE,CAAC,EAAE,CAAC;IAAEC,CAAC,EAAE;EAAE,CAAC,CAAC;EACxD,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGnE,QAAQ,CAAC,IAAI,CAAC;EAE9CF,SAAS,CAAC,MAAM;IACZ,MAAMsE,gBAAgB,GAAG,MAAAA,CAAA,KAAY;MACjC,IAAI;QACA,MAAMC,GAAG,GAAG,MAAMhE,WAAW,CAACiE,OAAO,CAACxD,MAAM,CAAC;QAC7C4B,OAAO,CAAC2B,GAAG,CAACE,IAAI,CAAC9B,IAAI,CAAC;QACtBO,cAAc,CAACqB,GAAG,CAACE,IAAI,CAAC9B,IAAI,CAACM,WAAW,IAAI,EAAE,CAAC;MACnD,CAAC,CAAC,OAAOyB,GAAG,EAAE;QACV/D,KAAK,CAACgE,KAAK,CAAC,0BAA0B,CAAC;QACvC1D,QAAQ,CAAC,YAAY,CAAC;MAC1B;IACJ,CAAC;IAEDqD,gBAAgB,CAAC,CAAC;IAElB,IAAInD,MAAM,EAAE;MACRA,MAAM,CAACyD,IAAI,CAAC,WAAW,EAAE;QAAE5D,MAAM;QAAE6D,MAAM,EAAE3D,IAAI,CAAC4D,GAAG;QAAEC,QAAQ,EAAE7D,IAAI,CAAC8D;MAAK,CAAC,CAAC;MAE3E7D,MAAM,CAAC8D,EAAE,CAAC,aAAa,EAAGR,IAAI,IAAK9D,KAAK,CAACuE,OAAO,CAAC,GAAGT,IAAI,CAACM,QAAQ,SAAS,CAAC,CAAC;MAC5E5D,MAAM,CAAC8D,EAAE,CAAC,cAAc,EAAGE,KAAK,IAAKrC,eAAe,CAACqC,KAAK,CAAC,CAAC;MAC5DhE,MAAM,CAAC8D,EAAE,CAAC,cAAc,EAAGG,GAAG,IAAKpC,WAAW,CAAEqC,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAED,GAAG,CAAC,CAAC,CAAC;MACzEjE,MAAM,CAAC8D,EAAE,CAAC,cAAc,EAAGK,CAAC,IAAKtC,WAAW,CAACsC,CAAC,CAAC,CAAC;MAChDnE,MAAM,CAAC8D,EAAE,CAAC,SAAS,EAAGR,IAAI,IAAKc,UAAU,CAACd,IAAI,CAAC,CAAC;MAChDtD,MAAM,CAAC8D,EAAE,CAAC,OAAO,EAAGR,IAAI,IAAKe,WAAW,CAACf,IAAI,CAAC,CAAC;MAC/CtD,MAAM,CAAC8D,EAAE,CAAC,eAAe,EAAE,MAAM;QAC7BQ,gBAAgB,CAAC,CAAC;QAClB5B,UAAU,CAAC,EAAE,CAAC;QACdE,eAAe,CAAC,CAAC,CAAC,CAAC;MACvB,CAAC,CAAC;MACF5C,MAAM,CAAC8D,EAAE,CAAC,cAAc,EAAGR,IAAI,IAAK;QAChC,IAAIA,IAAI,EAAE;UACNiB,gBAAgB,CAACjB,IAAI,CAAC;UACtBZ,UAAU,CAAC,CAACY,IAAI,CAAC,CAAC;UAClBV,eAAe,CAAC,CAAC,CAAC;QACtB;MACJ,CAAC,CAAC;MACF5C,MAAM,CAAC8D,EAAE,CAAC,MAAM,EAAGU,KAAK,IAAKD,gBAAgB,CAACC,KAAK,CAAC,CAAC;MACrDxE,MAAM,CAAC8D,EAAE,CAAC,MAAM,EAAGU,KAAK,IAAKD,gBAAgB,CAACC,KAAK,CAAC,CAAC;IACzD;IAEA,OAAO,MAAM;MACT,IAAIxE,MAAM,EAAEA,MAAM,CAACyD,IAAI,CAAC,YAAY,EAAE;QAAE5D,MAAM;QAAE6D,MAAM,EAAE3D,IAAI,CAAC4D,GAAG;QAAEC,QAAQ,EAAE7D,IAAI,CAAC8D;MAAK,CAAC,CAAC;IAC5F,CAAC;EACL,CAAC,EAAE,CAAChE,MAAM,EAAEG,MAAM,EAAED,IAAI,EAAED,QAAQ,CAAC,CAAC;EAEpCjB,SAAS,CAAC,MAAM;IACZ,MAAM4F,MAAM,GAAGxE,SAAS,CAACyE,OAAO;IAChC,MAAMC,SAAS,GAAGF,MAAM,CAACG,aAAa;IAEtC,MAAMC,YAAY,GAAGA,CAAA,KAAM;MACvB,MAAMC,IAAI,GAAGH,SAAS,CAACI,qBAAqB,CAAC,CAAC;MAC9C,MAAMC,GAAG,GAAGC,MAAM,CAACC,gBAAgB,IAAI,CAAC;;MAExC;MACA,MAAMC,UAAU,GAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;MACnD,MAAMC,OAAO,GAAGH,UAAU,CAACI,UAAU,CAAC,IAAI,CAAC;MAC3CJ,UAAU,CAACK,KAAK,GAAGf,MAAM,CAACe,KAAK;MAC/BL,UAAU,CAACM,MAAM,GAAGhB,MAAM,CAACgB,MAAM;MACjCH,OAAO,CAACI,SAAS,CAACjB,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;MAE/BA,MAAM,CAACe,KAAK,GAAGV,IAAI,CAACU,KAAK,GAAGR,GAAG;MAC/BP,MAAM,CAACgB,MAAM,GAAGX,IAAI,CAACW,MAAM,GAAGT,GAAG;MACjCP,MAAM,CAACkB,KAAK,CAACH,KAAK,GAAG,GAAGV,IAAI,CAACU,KAAK,IAAI;MACtCf,MAAM,CAACkB,KAAK,CAACF,MAAM,GAAG,GAAGX,IAAI,CAACW,MAAM,IAAI;MAExC,MAAMG,OAAO,GAAGnB,MAAM,CAACc,UAAU,CAAC,IAAI,CAAC;MACvCK,OAAO,CAACC,KAAK,CAACb,GAAG,EAAEA,GAAG,CAAC;MACvBY,OAAO,CAACE,OAAO,GAAG,OAAO;MACzBF,OAAO,CAACG,QAAQ,GAAG,OAAO;MAC1BH,OAAO,CAACF,SAAS,CAACP,UAAU,EAAE,CAAC,EAAE,CAAC,EAAEA,UAAU,CAACK,KAAK,GAAGR,GAAG,EAAEG,UAAU,CAACM,MAAM,GAAGT,GAAG,EAAE,CAAC,EAAE,CAAC,EAAEF,IAAI,CAACU,KAAK,EAAEV,IAAI,CAACW,MAAM,CAAC;MACnHvF,UAAU,CAACwE,OAAO,GAAGkB,OAAO;IAChC,CAAC;IAED,MAAMI,cAAc,GAAG,IAAIC,cAAc,CAACpB,YAAY,CAAC;IACvDmB,cAAc,CAACE,OAAO,CAACvB,SAAS,CAAC;IACjCE,YAAY,CAAC,CAAC;IAEd,OAAO,MAAMmB,cAAc,CAACG,UAAU,CAAC,CAAC;EAC5C,CAAC,EAAE,EAAE,CAAC;EAEN,MAAM5B,gBAAgB,GAAIC,KAAK,IAAK;IAChC,IAAI,CAACA,KAAK,EAAE,OAAOF,gBAAgB,CAAC,CAAC;IACrC,MAAM8B,KAAK,GAAG,IAAIC,KAAK,CAAC,CAAC;IACzBD,KAAK,CAACE,GAAG,GAAG9B,KAAK;IACjB4B,KAAK,CAACG,MAAM,GAAG,MAAM;MACjB,MAAM9B,MAAM,GAAGxE,SAAS,CAACyE,OAAO;MAChC,IAAI,CAACD,MAAM,IAAI,CAACvE,UAAU,CAACwE,OAAO,EAAE;MACpCJ,gBAAgB,CAAC,CAAC;MAClBpE,UAAU,CAACwE,OAAO,CAACgB,SAAS,CAACU,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE3B,MAAM,CAACe,KAAK,IAAIP,MAAM,CAACC,gBAAgB,IAAI,CAAC,CAAC,EAAET,MAAM,CAACgB,MAAM,IAAIR,MAAM,CAACC,gBAAgB,IAAI,CAAC,CAAC,CAAC;IAC5I,CAAC;EACL,CAAC;EAED,MAAMZ,gBAAgB,GAAGA,CAAA,KAAM;IAC3B,MAAMG,MAAM,GAAGxE,SAAS,CAACyE,OAAO;IAChC,IAAI,CAACD,MAAM,IAAI,CAACvE,UAAU,CAACwE,OAAO,EAAE;IACpC,MAAMM,GAAG,GAAGC,MAAM,CAACC,gBAAgB,IAAI,CAAC;IACxChF,UAAU,CAACwE,OAAO,CAAC8B,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE/B,MAAM,CAACe,KAAK,GAAGR,GAAG,EAAEP,MAAM,CAACgB,MAAM,GAAGT,GAAG,CAAC;EAC/E,CAAC;EAED,MAAMyB,WAAW,GAAIC,CAAC,IAAK;IACvB,MAAMjC,MAAM,GAAGxE,SAAS,CAACyE,OAAO;IAChC,IAAI,CAACD,MAAM,EAAE,OAAO;MAAE1B,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAE,CAAC;IAClC,MAAM8B,IAAI,GAAGL,MAAM,CAACM,qBAAqB,CAAC,CAAC;IAC3C,OAAO;MACHhC,CAAC,EAAE2D,CAAC,CAACC,OAAO,GAAG7B,IAAI,CAAC8B,IAAI;MACxB5D,CAAC,EAAE0D,CAAC,CAACG,OAAO,GAAG/B,IAAI,CAACgC;IACxB,CAAC;EACL,CAAC;EAED,MAAMC,YAAY,GAAIL,CAAC,IAAK;IACxB,MAAMjC,MAAM,GAAGxE,SAAS,CAACyE,OAAO;IAChC,IAAI,CAACD,MAAM,IAAI,CAACvE,UAAU,CAACwE,OAAO,IAAIrE,IAAI,KAAK,KAAK,EAAE;IAEtD,MAAM2G,GAAG,GAAGP,WAAW,CAACC,CAAC,CAAC;IAC1B5D,WAAW,CAACkE,GAAG,CAAC;IAChB5G,YAAY,CAAC,IAAI,CAAC;;IAElB;IACA,MAAM+E,UAAU,GAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;IACnDF,UAAU,CAACK,KAAK,GAAGf,MAAM,CAACe,KAAK;IAC/BL,UAAU,CAACM,MAAM,GAAGhB,MAAM,CAACgB,MAAM;IACjCN,UAAU,CAACI,UAAU,CAAC,IAAI,CAAC,CAACG,SAAS,CAACjB,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;IACnDvB,WAAW,CAACiC,UAAU,CAAC;IAEvB,IAAI9E,IAAI,KAAK,QAAQ,IAAIA,IAAI,KAAK,aAAa,IAAIA,IAAI,KAAK,QAAQ,EAAE;MAClEH,UAAU,CAACwE,OAAO,CAACuC,SAAS,CAAC,CAAC;MAC9B/G,UAAU,CAACwE,OAAO,CAACwC,MAAM,CAACF,GAAG,CAACjE,CAAC,EAAEiE,GAAG,CAAChE,CAAC,CAAC;IAC3C;EACJ,CAAC;EAED,MAAMmE,IAAI,GAAIT,CAAC,IAAK;IAChB,IAAI,CAACvG,SAAS,IAAI,CAACD,UAAU,CAACwE,OAAO,EAAE;IACvC,MAAMsC,GAAG,GAAGP,WAAW,CAACC,CAAC,CAAC;IAC1B,MAAMU,GAAG,GAAGlH,UAAU,CAACwE,OAAO;IAC9B,MAAMM,GAAG,GAAGC,MAAM,CAACC,gBAAgB,IAAI,CAAC;IAExCkC,GAAG,CAACC,SAAS,GAAG1G,IAAI;IACpByG,GAAG,CAACrG,WAAW,GAAGN,KAAK;IACvB2G,GAAG,CAACE,WAAW,GAAGjH,IAAI,KAAK,aAAa,GAAIQ,OAAO,GAAG,GAAG,GAAIA,OAAO;IACpEuG,GAAG,CAACG,WAAW,CAACxG,WAAW,KAAK,QAAQ,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC,GAAG,EAAE,CAAC;IAEzD,IAAIV,IAAI,KAAK,QAAQ,IAAIA,IAAI,KAAK,aAAa,EAAE;MAC7C+G,GAAG,CAACI,wBAAwB,GAAG,aAAa;MAC5CJ,GAAG,CAACK,MAAM,CAACT,GAAG,CAACjE,CAAC,EAAEiE,GAAG,CAAChE,CAAC,CAAC;MACxBoE,GAAG,CAACM,MAAM,CAAC,CAAC;MACZ1H,MAAM,CAACyD,IAAI,CAAC,SAAS,EAAE;QAAE5D,MAAM;QAAE8H,WAAW,EAAE;UAAE5E,CAAC,EAAEiE,GAAG,CAACjE,CAAC;UAAEC,CAAC,EAAEgE,GAAG,CAAChE,CAAC;UAAEvC,KAAK;UAAEE,IAAI;UAAEE,OAAO,EAAEuG,GAAG,CAACE,WAAW;UAAEjH;QAAK;MAAE,CAAC,CAAC;IACxH,CAAC,MAAM,IAAIA,IAAI,KAAK,QAAQ,IAAIA,IAAI,KAAK,kBAAkB,EAAE;MACzD+G,GAAG,CAACI,wBAAwB,GAAG,iBAAiB;MAChD,MAAMI,UAAU,GAAGvH,IAAI,KAAK,kBAAkB,GAAG,CAAC,GAAGM,IAAI,GAAG,CAAC;MAC7DyG,GAAG,CAACC,SAAS,GAAGO,UAAU;MAC1BR,GAAG,CAACK,MAAM,CAACT,GAAG,CAACjE,CAAC,EAAEiE,GAAG,CAAChE,CAAC,CAAC;MACxBoE,GAAG,CAACM,MAAM,CAAC,CAAC;MACZ1H,MAAM,CAACyD,IAAI,CAAC,OAAO,EAAE;QAAE5D,MAAM;QAAEgI,SAAS,EAAE;UAAE9E,CAAC,EAAEiE,GAAG,CAACjE,CAAC;UAAEC,CAAC,EAAEgE,GAAG,CAAChE,CAAC;UAAErC,IAAI,EAAEiH;QAAW;MAAE,CAAC,CAAC;IACzF,CAAC,MAAM,IAAI,CAAC,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,CAAC,CAACvG,QAAQ,CAAChB,IAAI,CAAC,EAAE;MAC3D;MACA,IAAI,CAAC4C,QAAQ,EAAE;MACfqB,gBAAgB,CAAC,CAAC;MAClB8C,GAAG,CAAC1B,SAAS,CAACzC,QAAQ,EAAE,CAAC,EAAE,CAAC,EAAEA,QAAQ,CAACuC,KAAK,GAAGR,GAAG,EAAE/B,QAAQ,CAACwC,MAAM,GAAGT,GAAG,CAAC;MAE1EoC,GAAG,CAACH,SAAS,CAAC,CAAC;MACf,IAAI5G,IAAI,KAAK,MAAM,EAAE;QACjB+G,GAAG,CAACF,MAAM,CAACrE,QAAQ,CAACE,CAAC,EAAEF,QAAQ,CAACG,CAAC,CAAC;QAClCoE,GAAG,CAACK,MAAM,CAACT,GAAG,CAACjE,CAAC,EAAEiE,GAAG,CAAChE,CAAC,CAAC;MAC5B,CAAC,MAAM,IAAI3C,IAAI,KAAK,MAAM,EAAE;QACxB,IAAIY,IAAI,EAAE;UACNmG,GAAG,CAACU,SAAS,GAAGrH,KAAK;UACrB2G,GAAG,CAACW,QAAQ,CAAClF,QAAQ,CAACE,CAAC,EAAEF,QAAQ,CAACG,CAAC,EAAEgE,GAAG,CAACjE,CAAC,GAAGF,QAAQ,CAACE,CAAC,EAAEiE,GAAG,CAAChE,CAAC,GAAGH,QAAQ,CAACG,CAAC,CAAC;QAChF;QACAoE,GAAG,CAACY,UAAU,CAACnF,QAAQ,CAACE,CAAC,EAAEF,QAAQ,CAACG,CAAC,EAAEgE,GAAG,CAACjE,CAAC,GAAGF,QAAQ,CAACE,CAAC,EAAEiE,GAAG,CAAChE,CAAC,GAAGH,QAAQ,CAACG,CAAC,CAAC;MAClF,CAAC,MAAM,IAAI3C,IAAI,KAAK,QAAQ,EAAE;QAC1B,MAAM4H,MAAM,GAAGC,IAAI,CAACC,IAAI,CAACD,IAAI,CAACE,GAAG,CAACpB,GAAG,CAACjE,CAAC,GAAGF,QAAQ,CAACE,CAAC,EAAE,CAAC,CAAC,GAAGmF,IAAI,CAACE,GAAG,CAACpB,GAAG,CAAChE,CAAC,GAAGH,QAAQ,CAACG,CAAC,EAAE,CAAC,CAAC,CAAC;QAC3FoE,GAAG,CAACiB,GAAG,CAACxF,QAAQ,CAACE,CAAC,EAAEF,QAAQ,CAACG,CAAC,EAAEiF,MAAM,EAAE,CAAC,EAAE,CAAC,GAAGC,IAAI,CAACI,EAAE,CAAC;QACvD,IAAIrH,IAAI,EAAE;UACNmG,GAAG,CAACU,SAAS,GAAGrH,KAAK;UACrB2G,GAAG,CAACnG,IAAI,CAAC,CAAC;QACd;MACJ,CAAC,MAAM,IAAIZ,IAAI,KAAK,OAAO,EAAE;QACzBkI,SAAS,CAACnB,GAAG,EAAEvE,QAAQ,CAACE,CAAC,EAAEF,QAAQ,CAACG,CAAC,EAAEgE,GAAG,CAACjE,CAAC,EAAEiE,GAAG,CAAChE,CAAC,CAAC;MACxD;MACAoE,GAAG,CAACM,MAAM,CAAC,CAAC;IAChB;EACJ,CAAC;EAED,MAAMa,SAAS,GAAGA,CAACnB,GAAG,EAAEoB,KAAK,EAAEC,KAAK,EAAEC,GAAG,EAAEC,GAAG,KAAK;IAC/C,MAAMC,OAAO,GAAGjI,IAAI,GAAG,CAAC;IACxB,MAAMkI,KAAK,GAAGX,IAAI,CAACY,KAAK,CAACH,GAAG,GAAGF,KAAK,EAAEC,GAAG,GAAGF,KAAK,CAAC;IAClDpB,GAAG,CAACF,MAAM,CAACsB,KAAK,EAAEC,KAAK,CAAC;IACxBrB,GAAG,CAACK,MAAM,CAACiB,GAAG,EAAEC,GAAG,CAAC;IACpBvB,GAAG,CAACK,MAAM,CAACiB,GAAG,GAAGE,OAAO,GAAGV,IAAI,CAACa,GAAG,CAACF,KAAK,GAAGX,IAAI,CAACI,EAAE,GAAG,CAAC,CAAC,EAAEK,GAAG,GAAGC,OAAO,GAAGV,IAAI,CAACc,GAAG,CAACH,KAAK,GAAGX,IAAI,CAACI,EAAE,GAAG,CAAC,CAAC,CAAC;IACxGlB,GAAG,CAACF,MAAM,CAACwB,GAAG,EAAEC,GAAG,CAAC;IACpBvB,GAAG,CAACK,MAAM,CAACiB,GAAG,GAAGE,OAAO,GAAGV,IAAI,CAACa,GAAG,CAACF,KAAK,GAAGX,IAAI,CAACI,EAAE,GAAG,CAAC,CAAC,EAAEK,GAAG,GAAGC,OAAO,GAAGV,IAAI,CAACc,GAAG,CAACH,KAAK,GAAGX,IAAI,CAACI,EAAE,GAAG,CAAC,CAAC,CAAC;EAC5G,CAAC;EAED,MAAMW,WAAW,GAAGA,CAAA,KAAM;IACtB,MAAMxE,MAAM,GAAGxE,SAAS,CAACyE,OAAO;IAChC,IAAI,CAACvE,SAAS,IAAI,CAACsE,MAAM,EAAE;IAC3BrE,YAAY,CAAC,KAAK,CAAC;IACnB8C,WAAW,CAAC,IAAI,CAAC;IAEjB,MAAMgG,OAAO,GAAGzE,MAAM,CAAC0E,SAAS,CAAC,CAAC;IAClC,MAAMC,UAAU,GAAG3G,OAAO,CAAC4G,KAAK,CAAC,CAAC,EAAE1G,YAAY,GAAG,CAAC,CAAC;IACrDyG,UAAU,CAACE,IAAI,CAACJ,OAAO,CAAC;IACxBxG,UAAU,CAAC0G,UAAU,CAAC;IACtBxG,eAAe,CAACwG,UAAU,CAACG,MAAM,GAAG,CAAC,CAAC;IACtCvJ,MAAM,CAACyD,IAAI,CAAC,aAAa,EAAE;MAAE5D,MAAM;MAAE2J,UAAU,EAAEN;IAAQ,CAAC,CAAC;EAC/D,CAAC;EAED,MAAMO,UAAU,GAAGA,CAAA,KAAM;IACrB,IAAI9G,YAAY,GAAG,CAAC,EAAE;MAClB,MAAM+G,QAAQ,GAAG/G,YAAY,GAAG,CAAC;MACjC,MAAM6B,KAAK,GAAG/B,OAAO,CAACiH,QAAQ,CAAC;MAC/B9G,eAAe,CAAC8G,QAAQ,CAAC;MACzBnF,gBAAgB,CAACC,KAAK,CAAC;MACvBxE,MAAM,CAACyD,IAAI,CAAC,MAAM,EAAE;QAAE5D,MAAM;QAAE8J,WAAW,EAAEnF;MAAM,CAAC,CAAC;MACnDxE,MAAM,CAACyD,IAAI,CAAC,aAAa,EAAE;QAAE5D,MAAM;QAAE2J,UAAU,EAAEhF;MAAM,CAAC,CAAC;IAC7D;EACJ,CAAC;EAED,MAAMoF,UAAU,GAAGA,CAAA,KAAM;IACrB,IAAIjH,YAAY,GAAGF,OAAO,CAAC8G,MAAM,GAAG,CAAC,EAAE;MACnC,MAAMG,QAAQ,GAAG/G,YAAY,GAAG,CAAC;MACjC,MAAM6B,KAAK,GAAG/B,OAAO,CAACiH,QAAQ,CAAC;MAC/B9G,eAAe,CAAC8G,QAAQ,CAAC;MACzBnF,gBAAgB,CAACC,KAAK,CAAC;MACvBxE,MAAM,CAACyD,IAAI,CAAC,MAAM,EAAE;QAAE5D,MAAM;QAAE8J,WAAW,EAAEnF;MAAM,CAAC,CAAC;MACnDxE,MAAM,CAACyD,IAAI,CAAC,aAAa,EAAE;QAAE5D,MAAM;QAAE2J,UAAU,EAAEhF;MAAM,CAAC,CAAC;IAC7D;EACJ,CAAC;EAED,MAAMJ,UAAU,GAAId,IAAI,IAAK;IACzB,MAAM;MAAEP,CAAC;MAAEC,CAAC;MAAEvC,KAAK;MAAEE,IAAI;MAAEE,OAAO;MAAER;IAAK,CAAC,GAAGiD,IAAI;IACjD,MAAM8D,GAAG,GAAGlH,UAAU,CAACwE,OAAO;IAC9B,MAAMmF,SAAS,GAAGzC,GAAG,CAACE,WAAW;IACjC,MAAMwC,UAAU,GAAG1C,GAAG,CAACrG,WAAW;IAClC,MAAMgJ,SAAS,GAAG3C,GAAG,CAACC,SAAS;IAE/BD,GAAG,CAACE,WAAW,GAAGzG,OAAO,IAAI,CAAC;IAC9BuG,GAAG,CAACrG,WAAW,GAAGN,KAAK;IACvB2G,GAAG,CAACC,SAAS,GAAG1G,IAAI;IACpByG,GAAG,CAACH,SAAS,CAAC,CAAC;IACfG,GAAG,CAACiB,GAAG,CAACtF,CAAC,EAAEC,CAAC,EAAErC,IAAI,GAAG,CAAC,EAAE,CAAC,EAAEuH,IAAI,CAACI,EAAE,GAAG,CAAC,CAAC;IACvClB,GAAG,CAACU,SAAS,GAAGrH,KAAK;IACrB2G,GAAG,CAACnG,IAAI,CAAC,CAAC;IAEVmG,GAAG,CAACE,WAAW,GAAGuC,SAAS;IAC3BzC,GAAG,CAACrG,WAAW,GAAG+I,UAAU;IAC5B1C,GAAG,CAACC,SAAS,GAAG0C,SAAS;EAC7B,CAAC;EAED,MAAM1F,WAAW,GAAIf,IAAI,IAAK;IAC1B,MAAM;MAAEP,CAAC;MAAEC,CAAC;MAAErC;IAAK,CAAC,GAAG2C,IAAI;IAC3B,MAAM8D,GAAG,GAAGlH,UAAU,CAACwE,OAAO;IAC9B,MAAMsF,OAAO,GAAG5C,GAAG,CAACI,wBAAwB;IAC5CJ,GAAG,CAACI,wBAAwB,GAAG,iBAAiB;IAChDJ,GAAG,CAACH,SAAS,CAAC,CAAC;IACfG,GAAG,CAACiB,GAAG,CAACtF,CAAC,EAAEC,CAAC,EAAErC,IAAI,EAAE,CAAC,EAAEuH,IAAI,CAACI,EAAE,GAAG,CAAC,CAAC;IACnClB,GAAG,CAACnG,IAAI,CAAC,CAAC;IACVmG,GAAG,CAACI,wBAAwB,GAAGwC,OAAO;EAC1C,CAAC;EAED,MAAMC,gBAAgB,GAAGA,CAAA,KAAM;IAC3B,IAAIhF,MAAM,CAACiF,OAAO,CAAC,YAAY,CAAC,EAAElK,MAAM,CAACyD,IAAI,CAAC,aAAa,EAAE;MAAE5D,MAAM;MAAE6D,MAAM,EAAE3D,IAAI,CAAC4D;IAAI,CAAC,CAAC;EAC9F,CAAC;EAED,oBACIjE,OAAA;IAAKyK,SAAS,EAAC,qBAAqB;IAAAC,QAAA,gBAEhC1K,OAAA;MAAQyK,SAAS,EAAC,gBAAgB;MAAAC,QAAA,gBAC9B1K,OAAA;QAAKyK,SAAS,EAAC,yBAAyB;QAAAC,QAAA,gBACpC1K,OAAA;UAAKyK,SAAS,EAAC,yBAAyB;UAAAC,QAAA,gBACpC1K,OAAA;YAAKyK,SAAS,EAAC,8GAA8G;YAACE,OAAO,EAAEA,CAAA,KAAMvK,QAAQ,CAAC,YAAY,CAAE;YAAAsK,QAAA,eAChK1K,OAAA;cAAMyK,SAAS,EAAC,+BAA+B;cAAAC,QAAA,EAAC;YAAC;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACvD,CAAC,eACN/K,OAAA;YAAA0K,QAAA,gBACI1K,OAAA;cAAIyK,SAAS,EAAC,uEAAuE;cAAAC,QAAA,EAAE,CAAA5I,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEkJ,QAAQ,KAAI;YAAgB;cAAAJ,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eAC/H/K,OAAA;cAAMyK,SAAS,EAAC,gEAAgE;cAAAC,QAAA,GAAE1I,YAAY,CAAC6H,MAAM,EAAC,SAAO;YAAA;cAAAe,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnH,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CAAC,eAEN/K,OAAA;UAAKyK,SAAS,EAAC;QAAuB;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,EAG5CrJ,aAAa,iBACV1B,OAAA;UAAKyK,SAAS,EAAC,8EAA8E;UAAAC,QAAA,gBAEzF1K,OAAA;YAAKyK,SAAS,EAAC,yBAAyB;YAAAC,QAAA,gBACpC1K,OAAA;cAAKyK,SAAS,EAAC,+BAA+B;cAAAC,QAAA,EACzCjJ,MAAM,CAACkI,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAACsB,GAAG,CAACC,CAAC,iBACrBlL,OAAA;gBAEI2K,OAAO,EAAEA,CAAA,KAAM3J,QAAQ,CAACkK,CAAC,CAAE;gBAC3BT,SAAS,EAAE,+DAA+D1J,KAAK,KAAKmK,CAAC,GAAG,gDAAgD,GAAG,iBAAiB,EAAG;gBAC/JjF,KAAK,EAAE;kBAAEkF,eAAe,EAAED;gBAAE;cAAE,GAHzBA,CAAC;gBAAAN,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAIT,CACJ;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACD,CAAC,eACN/K,OAAA;cAAKyK,SAAS,EAAC,+BAA+B;cAAAC,QAAA,EACzCjJ,MAAM,CAACkI,KAAK,CAAC,CAAC,CAAC,CAACsB,GAAG,CAACC,CAAC,iBAClBlL,OAAA;gBAEI2K,OAAO,EAAEA,CAAA,KAAM3J,QAAQ,CAACkK,CAAC,CAAE;gBAC3BT,SAAS,EAAE,+DAA+D1J,KAAK,KAAKmK,CAAC,GAAG,gDAAgD,GAAG,iBAAiB,EAAG;gBAC/JjF,KAAK,EAAE;kBAAEkF,eAAe,EAAED;gBAAE;cAAE,GAHzBA,CAAC;gBAAAN,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAIT,CACJ;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACD,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACL,CAAC,eAEN/K,OAAA;YAAKyK,SAAS,EAAC;UAAuB;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAG7C/K,OAAA;YAAKyK,SAAS,EAAC,8BAA8B;YAAAC,QAAA,gBACzC1K,OAAA;cAAMyK,SAAS,EAAC,+DAA+D;cAAAC,QAAA,EAAC;YAAI;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC3F/K,OAAA;cACIoL,IAAI,EAAC,OAAO;cAACC,GAAG,EAAC,GAAG;cAACC,GAAG,EAAC,IAAI;cAACC,KAAK,EAAEtK,IAAK;cAC1CuK,QAAQ,EAAGxE,CAAC,IAAK9F,OAAO,CAACuK,QAAQ,CAACzE,CAAC,CAAC0E,MAAM,CAACH,KAAK,CAAC,CAAE;cACnDd,SAAS,EAAC;YAAqF;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAClG,CAAC,eACF/K,OAAA;cAAMyK,SAAS,EAAC,6DAA6D;cAAAC,QAAA,EAAEzJ;YAAI;cAAA2J,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC1F,CAAC,eAEN/K,OAAA;YAAKyK,SAAS,EAAC;UAAuB;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAG7C/K,OAAA;YAAKyK,SAAS,EAAC,8BAA8B;YAAAC,QAAA,gBACzC1K,OAAA;cAAMyK,SAAS,EAAC,+DAA+D;cAAAC,QAAA,EAAC;YAAO;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC9F/K,OAAA;cACIoL,IAAI,EAAC,OAAO;cAACC,GAAG,EAAC,KAAK;cAACC,GAAG,EAAC,GAAG;cAACK,IAAI,EAAC,KAAK;cAACJ,KAAK,EAAEpK,OAAQ;cACzDqK,QAAQ,EAAGxE,CAAC,IAAK5F,UAAU,CAACwK,UAAU,CAAC5E,CAAC,CAAC0E,MAAM,CAACH,KAAK,CAAC,CAAE;cACxDd,SAAS,EAAC;YAAqF;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAClG,CAAC,eACF/K,OAAA;cAAMyK,SAAS,EAAC,6DAA6D;cAAAC,QAAA,GAAElC,IAAI,CAACqD,KAAK,CAAC1K,OAAO,GAAG,GAAG,CAAC,EAAC,GAAC;YAAA;cAAAyJ,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAChH,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CACR;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACA,CAAC,eAEN/K,OAAA;QAAKyK,SAAS,EAAC,yBAAyB;QAAAC,QAAA,gBACpC1K,OAAA;UAAQyK,SAAS,EAAC,oBAAoB;UAACE,OAAO,EAAEA,CAAA,KAAM;YAClDmB,SAAS,CAACC,SAAS,CAACC,SAAS,CAACzG,MAAM,CAAC0G,QAAQ,CAACC,IAAI,CAAC;YACnDpM,KAAK,CAACuE,OAAO,CAAC,cAAc,CAAC;UACjC,CAAE;UAAAqG,QAAA,EAAC;QAAoB;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eAChC/K,OAAA;UAAQyK,SAAS,EAAC,kBAAkB;UAAAC,QAAA,EAAC;QAAY;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eAC1D/K,OAAA;UAAKyK,SAAS,EAAC;QAA4B;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eAClD/K,OAAA;UAAQyK,SAAS,EAAC,aAAa;UAACE,OAAO,EAAEA,CAAA,KAAM7H,gBAAgB,CAAC,CAACD,aAAa,CAAE;UAAA6H,QAAA,eAC5E1K,OAAA;YAAMyK,SAAS,EAAC,SAAS;YAAAC,QAAA,EAAC;UAAE;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC/B,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACR,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACF,CAAC,eAGT/K,OAAA;MAAOyK,SAAS,EAAC,eAAe;MAAAC,QAAA,eAC5B1K,OAAA,CAACL,OAAO;QACJwM,UAAU,EAAExL,IAAK;QACjBC,OAAO,EAAEgB,gBAAiB;QAC1BwK,MAAM,EAAE/L,IAAI,CAAC4D,GAAG,MAAKnC,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEuK,IAAI,CAAC;QAChCC,OAAO,EAAE/B,gBAAiB;QAC1BgC,MAAM,EAAExC,UAAW;QACnByC,MAAM,EAAEtC,UAAW;QACnBuC,QAAQ,EAAEA,CAAA,KAAM,CAAE;MAAE;QAAA7B,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvB;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC,eAGR/K,OAAA;MAAMyK,SAAS,EAAC,aAAa;MAAAC,QAAA,gBACzB1K,OAAA;QAAKyK,SAAS,EAAC,2EAA2E;QAAAC,QAAA,eACtF1K,OAAA;UACI0M,GAAG,EAAEnM,SAAU;UACfoM,WAAW,EAAEtF,YAAa;UAC1BuF,WAAW,EAAEnF,IAAK;UAClBoF,SAAS,EAAEtD,WAAY;UACvBuD,UAAU,EAAEvD;QAAY;UAAAqB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC3B;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC,eAGN/K,OAAA,CAACH,YAAY;QACTc,IAAI,EAAEA,IAAK;QACXoM,OAAO,EAAElM,WAAY;QACrBE,KAAK,EAAEA,KAAM;QAACC,QAAQ,EAAEA,QAAS;QACjCC,IAAI,EAAEA,IAAK;QAACC,OAAO,EAAEA,OAAQ;QAC7BC,OAAO,EAAEA,OAAQ;QAACC,UAAU,EAAEA,UAAW;QACzCC,WAAW,EAAEA,WAAY;QAACC,cAAc,EAAEA,cAAe;QACzDC,IAAI,EAAEA,IAAK;QAACC,OAAO,EAAEA;MAAQ;QAAAoJ,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAChC,CAAC,eAGF/K,OAAA;QAAKyK,SAAS,EAAC,6GAA6G;QAAAC,QAAA,gBACxH1K,OAAA;UAAQyK,SAAS,EAAC,uEAAuE;UAAAC,QAAA,EAAC;QAAI;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACvG/K,OAAA;UAAKyK,SAAS,EAAC;QAAuB;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eAC7C/K,OAAA;UAAQyK,SAAS,EAAC,sCAAsC;UAAAC,QAAA,EAAC;QAAG;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACJ,CAAC,eAGP/K,OAAA;MAAOyK,SAAS,EAAE,kBAAkB5H,aAAa,GAAG,MAAM,GAAG,EAAE,EAAG;MAAA6H,QAAA,eAC9D1K,OAAA;QAAKyK,SAAS,EAAC,sBAAsB;QAAAC,QAAA,gBACjC1K,OAAA;UAAKyK,SAAS,EAAC,gDAAgD;UAAAC,QAAA,EAC1D,CAAC,MAAM,EAAE,OAAO,EAAE,OAAO,CAAC,CAACO,GAAG,CAAE+B,GAAG,iBAChChN,OAAA;YAEI2K,OAAO,EAAEA,CAAA,KAAMpI,YAAY,CAACyK,GAAG,CAAE;YACjCvC,SAAS,EAAE;AAC3C,4CAA4CnI,SAAS,KAAK0K,GAAG,GAAG,4DAA4D,GAAG,qCAAqC,EAAG;YAAAtC,QAAA,EAEtIsC;UAAG,GALCA,GAAG;YAAApC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAMJ,CACX;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD,CAAC,eACN/K,OAAA;UAAKyK,SAAS,EAAC,wBAAwB;UAAAC,QAAA,EAClCpI,SAAS,KAAK,MAAM,gBACjBtC,OAAA,CAACJ,IAAI;YAACsC,QAAQ,EAAEA,QAAS;YAAC+K,aAAa,EAAGC,GAAG,IAAK5M,MAAM,CAACyD,IAAI,CAAC,cAAc,EAAE;cAAE5D,MAAM;cAAEgN,OAAO,EAAED,GAAG;cAAElJ,MAAM,EAAE3D,IAAI,CAAC4D,GAAG;cAAEC,QAAQ,EAAE7D,IAAI,CAAC8D;YAAK,CAAC,CAAE;YAACiJ,WAAW,EAAE/M;UAAK;YAAAuK,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,GACrKzI,SAAS,KAAK,OAAO,gBACrBtC,OAAA;YAAKyK,SAAS,EAAC,KAAK;YAAAC,QAAA,gBAChB1K,OAAA;cAAOyK,SAAS,EAAC,2EAA2E;cAAAC,QAAA,gBACxF1K,OAAA;gBAAA0K,QAAA,EAAM;cAAW;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eACxB/K,OAAA;gBAAOoL,IAAI,EAAC,MAAM;gBAACX,SAAS,EAAC;cAAQ;gBAAAG,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACrC,CAAC,eACR/K,OAAA;cAAKyK,SAAS,EAAC,WAAW;cAAAC,QAAA,EACrBtI,WAAW,CAAC6I,GAAG,CAAC,CAACoC,CAAC,EAAEC,CAAC,kBAClBtN,OAAA;gBAAayK,SAAS,EAAC,sFAAsF;gBAAAC,QAAA,gBACzG1K,OAAA;kBAAMyK,SAAS,EAAC,4CAA4C;kBAAAC,QAAA,EAAE2C,CAAC,CAACzC;gBAAQ;kBAAAA,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC,eAChF/K,OAAA;kBAAMyK,SAAS,EAAC,iBAAiB;kBAAAC,QAAA,EAAC;gBAAE;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC;cAAA,GAFrCuC,CAAC;gBAAA1C,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAGN,CACR;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACD,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACL,CAAC,gBAEN/K,OAAA;YAAKyK,SAAS,EAAC,eAAe;YAAAC,QAAA,EACzB1I,YAAY,CAACiJ,GAAG,CAAC,CAACsC,CAAC,EAAED,CAAC,kBACnBtN,OAAA;cAAayK,SAAS,EAAC,0DAA0D;cAAAC,QAAA,gBAC7E1K,OAAA;gBAAKyK,SAAS,EAAC,2GAA2G;gBAAAC,QAAA,EAAE6C,CAAC,CAACrJ,QAAQ,CAAC,CAAC;cAAC;gBAAA0G,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eAChJ/K,OAAA;gBAAMyK,SAAS,EAAC,oCAAoC;gBAAAC,QAAA,EAAE6C,CAAC,CAACrJ;cAAQ;gBAAA0G,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC,eACxE/K,OAAA;gBAAKyK,SAAS,EAAC;cAA+C;gBAAAG,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC;YAAA,GAH/DuC,CAAC;cAAA1C,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAIN,CACR;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACD;QACR;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACA,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACP,CAAC;AAEd,CAAC;AAAC7K,EAAA,CA7eID,cAAc;EAAA,QACGX,SAAS,EACXC,WAAW,EACXC,OAAO,EACLC,SAAS;AAAA;AAAA+N,EAAA,GAJ1BvN,cAAc;AA+epB,eAAeA,cAAc;AAAC,IAAAuN,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}